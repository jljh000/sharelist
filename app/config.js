{"port":"59869","proxy_enable":0,"preview_enable":1,"index_enable":1,"webdav_path":"/webdav/","max_age_dir":900000,"max_age_file":300000,"max_age_download":0,"skin":"default","ignore_file_extensions":"","ignore_files":".passwd","readme_enable":1,"ignore_paths":{"__root__":["/readme.md"],"lb":[]},"max_age_download_sign":"sl_1610330007477","anonymous_uplod_enable":1,"anonymous_download":"","plugin_option":[{"key":"plugin_preview_media___video_previewable_formats","value":{"value":"mp4,ogg,webm,mpeg,m4v","label":"支持预览的视频后缀","placeholder":"文件扩展名，多个用逗号分隔"}},{"key":"plugin_preview_media___video_previewable_player","value":{"value":"dplayer","label":"视频预览播放器","options":[{"label":"默认","value":"default"},{"label":"DPlayer","value":"dplayer"}]}}],"custom_style":"","custom_script":"","proxy_paths":[""],"proxy_server":"","ocr_server":"https://api.reruin.net/ocr","smb_server_enable":0,"smb_server_port":8445,"smb_anonymous_enable":1,"token":"txqyfkq1","title":"T.","path":[{"name":"O1","path":"ctch://18731972636/772576316?password=txqyfkQ1&sessionKey=382adc9b-e1ce-4179-841a-84dbe3ec7207_family&sessionSecret=D91CD6F3BBC7CBF93A383B88F467E6E9&familyId=772576316"},{"name":"189","path":"ctcc://18731972636/?password=txqyfkQ1"},{"name":"T","path":"teambition://18731972636/5ffab7125b83a125f82f1eba/36e815e0c1f73f47/265347/df63e355d0b158a26e9aca3a695f23b6/?password=Txqyfkq1&cookie=TEAMBITION_SESSIONID%3DeyJhdXRoVXBkYXRlZCI6MTYxMDI3NTk2MzQwMSwibG9naW5Gcm9tIjoidGVhbWJpdGlvbiIsInVpZCI6IjVmZmFiNzEyMWQyMDhjODg2NzE5ZjBiOSIsInVzZXIiOnsiX2lkIjoiNWZmYWI3MTIxZDIwOGM4ODY3MTlmMGI5IiwibmFtZSI6IuaYn%2Bays%2BaXpeaciCIsImVtYWlsIjoiYWNjb3VudHNfNWZmYWI3MTI1MjZhYWIwMDE2OTkyYTNjQG1haWwudGVhbWJpdGlvbi5jb20iLCJhdmF0YXJVcmwiOiJodHRwczovL3Rjcy50ZWFtYml0aW9uLm5ldC90aHVtYm5haWwvMTEyMGM5NGI5YjgwYTY4YTI1N2ExZDEyNGUwYmVhNzgyMmU5L3cvMTAwL2gvMTAwIiwicmVnaW9uIjoiY24iLCJsYW5nIjoiIiwiaXNSb2JvdCI6ZmFsc2UsIm9wZW5JZCI6IiIsInBob25lRm9yTG9naW4iOiIxODczMTk3MjYzNiJ9fQ%3D%3D%3B%20path%3D%2F%3B%20expires%3DWed%2C%2010%20Feb%202021%2001%3A59%3A54%20GMT%3B%20domain%3D.teambition.com%3B%20secure%3B%20httponly%3B%20TEAMBITION_SESSIONID.sig%3DrkvfAmapOlytclw-EHXuivTQlUw%3B%20path%3D%2F%3B%20expires%3DWed%2C%2010%20Feb%202021%2001%3A59%3A54%20GMT%3B%20domain%3D.teambition.com%3B%20secure%3B%20httponly"},{"name":"G","path":"gda://324650519528-p0011h1eolstchtrkes7o4aa277kqgg5.apps.googleusercontent.com/root?client_secret=A63NRvF_V3V44n0o_JqpDMru&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob&refresh_token=1%2F%2F0dU7fdV3IsGpGCgYIARAAGA0SNwF-L9Ir2vSQ9sUqmgrT4qpTFdTUJ2pMeK_XG5Nq_PqbMKccZg2Nr5il5aUr_FgSi1HMkshJOmw"},{"name":"O","path":"oda:/->3d23bcf0-66dc-4954-8612-54c1bff70efa|ofOVO46%3B%24kvocvDGOH168%23%24|https://xhhdtyy.herokuapp.com/O|M.R3_BAY.Ce*Q7owYWjYomGDs6ro*ePhiibzUAn6r8QAG5VFs4TREA12QuObIo1jXP0Q4jN8ZLcVEUeUbQDHGaRcy5MAU0DyOXo7sd!7eXUwK8Mmj13cAevrIwIsm2n6DUncvpz!lmJywokfQb4k*P4sF7Ynrz2nnE2IybpS8SnGjU5TpOc2wd8m259VNpKaumxqYCKP3cZ9o5UwQxuqYrV1vWKcivajuqD!CSZ8m36IwljjJM8xNne9s0NpB4WeHIVSQtKcEf!Fp*LI0hUrnvxwjsoDw5YEeRy1H05wcIHiWY7dbaM7aApZRLPz1HFRbE!S0coYXfXuB4lqaHdq3TFyaw2Im3!zS6ysBTaO2euSBZN*mJe3EqH2ua6PZJZxU0bpLWfN3fPmFu7n62BlyTpWTNafrHlk$"},{"name":"G.","path":"gda://680768625088-38veio8lest33tdeq7flq0k1a0l9d6e5.apps.googleusercontent.com/root?client_secret=BoiRn4ZpDlnQKNzfrSWo5JHd&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob&refresh_token=1%2F%2F0d_GUQ8LBXdkFCgYIARAAGA0SNwF-L9Irb2oNvsl1RG7CwFI-kbNPkt0zii-1qSB8XF1HWh04OcxeJYvdnA-0yPkrQcktnC5wbDU"},{"name":"O.","path":"oda:/->1ac3701b-cbbb-4bf0-bd21-07979a95d844|ohozTM4%23%5D~iceCPBHX7841%23|https://xhhdtyy.herokuapp.com/O.|M.R3_BAY.CbPpzPuXQstZJC13g0NV1nKCVAwUJExPc8y5AVEy9a!oqUALGlqAFDGSACIs6o3Ds8HoiefFQH7VdyGL04gZR1vK795emrpzaqgXBPTTV9xpvaCCU2l3JpQO8SB8XCCbsJUzdymZpg2vvY4xGxs!49Suzyno6pKBLNKY7X9*vUqMojnF6MULmF6KnyoHYME92mL2Wx!DdjZD5dcOPiiDaNmBSS9PkWOxAh80kSrxRbZqs20ReP8sJMy0TLbJaO5eU2Ekb2Quyw3u6Atqf8wbHxcaSwQCMA0o7KjlFUVHCtVjvPOF4J14lnGXaOuta*da9jLbKxR4JsMRZIpDWEw1rBdXf9CIrhhrqxZF0OZvqFiAuM0XKBjpCc!KzCd6BvzACDu4WJKIjGAbvi!gS2yWAjE$"}],"language":""}
#!/usr/bin/env node

/**
 * Module dependencies.
 */

var app = require('./app/index')
var http = require('http');
var os = require('os')
var config = require('./app/config')
var fs = require('fs')
if(!fs.existsSync('./cache')){
  fs.mkdirSync('./cache');
}

var port = normalizePort(config.getConfig('port') || 33001);

var server = http.createServer(app.callback());


server.listen(port);
server.on('error', onError);
server.on('listening', onListening);


function normalizePort(val) {
  var port = parseInt(val, 10);

  if (isNaN(port)) {
    // named pipe
    return val;
  }

  if (port >= 0) {
    // port number
    return port;
  }

  return false;
}

function getIpv4() {
  var ifaces = os.networkInterfaces();
  for (var dev in ifaces) {
      for (var i in ifaces[dev]) {
          var details = ifaces[dev][i];
          if (/^\d+\./.test(details.address)) {
              return details.address;
          }
      }
  }
}

function onError(error) {
  if (error.syscall !== 'listen') {
    throw error;
  }

  var bind = typeof port === 'string'
    ? 'Pipe ' + port
    : 'Port ' + port;

  // handle specific listen errors with friendly messages
  switch (error.code) {
    case 'EACCES':
      console.error(bind + ' requires elevated privileges');
      process.exit(1);
      break;
    case 'EADDRINUSE':
      console.error(bind + ' is already in use');
      process.exit(1);
      break;
    default:
      throw error;
  }
}


function onListening() {
  console.log(new Date().toISOString())
  console.log('App is running at http://'+getIpv4()+':'+port+'/')
}
